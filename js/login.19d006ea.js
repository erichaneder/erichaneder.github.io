"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[535],{9117:function(e,r,s){s.r(r),s.d(r,{default:function(){return N}});var o=s(3396);const t={class:"login"};function a(e,r,s,a,n,i){const l=(0,o.up)("Login");return(0,o.wg)(),(0,o.iD)("div",t,[(0,o.Wm)(l)])}var n=s(9242),i=s(7139);const l={class:"min-h-screen flex flex-col items-center px-5"},u={class:"w-96 bg-white p-8 rounded shadow mt-20"},d=(0,o._)("div",{class:"h-0.5 bg-gray-200 w-36 mx-auto mt-2.5 mb-4"},null,-1),m={class:"mb-4"},c=(0,o._)("label",{for:"username",class:"block text-sm mb-1"},"Username / Email:",-1),p={key:0,class:"text-red-500"},f={class:"mb-6"},g=(0,o._)("label",{for:"password",class:"block text-sm mb-1"},"Password:",-1),h={key:0,class:"text-red-500"};function w(e,r,s,t,a,w){const b=(0,o.up)("NormalHeading"),v=(0,o.up)("CustomButton"),y=(0,o.up)("ErrorModal");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",l,[(0,o._)("div",u,[(0,o.Wm)(b,{text:"Login"}),d,(0,o._)("form",{onSubmit:r[4]||(r[4]=(0,n.iM)(((...e)=>w.submit&&w.submit(...e)),["prevent"]))},[(0,o._)("div",m,[c,(0,o.wy)((0,o._)("input",{type:"text",id:"username",class:"w-full h-10 px-2 border rounded","onUpdate:modelValue":r[0]||(r[0]=e=>a.form.values.username=e),onBlur:r[1]||(r[1]=e=>w.validate("username"))},null,544),[[n.nr,a.form.values.username]]),a.form.errors.username?((0,o.wg)(),(0,o.iD)("p",p,(0,i.zw)(a.form.errors.username),1)):(0,o.kq)("",!0)]),(0,o._)("div",f,[g,(0,o.wy)((0,o._)("input",{type:"password",id:"password",class:"w-full h-10 px-2 border rounded","onUpdate:modelValue":r[2]||(r[2]=e=>a.form.values.password=e),onBlur:r[3]||(r[3]=e=>w.validate("password"))},null,544),[[n.nr,a.form.values.password]]),a.form.errors.password?((0,o.wg)(),(0,o.iD)("p",h,(0,i.zw)(a.form.errors.password),1)):(0,o.kq)("",!0)]),(0,o.Wm)(v,{type:"submit",CustomButtonStyle:"w-full bg-teal-700 text-white p-2 rounded hover:bg-teal-500"},{default:(0,o.w5)((()=>[(0,o.Uk)("Login")])),_:1})],32)])]),(0,o.Wm)(y,{isVisible:a.isErrorModalVisible,errorMessage:a.errorMessage,"onUpdate:isVisible":r[5]||(r[5]=e=>a.isErrorModalVisible=e)},null,8,["isVisible","errorMessage"])],64)}s(7658);var b=s(9427),v=s(2260),y=s(1076),k=s(432),E=s(7629),x=s(4460);s(2801);class M extends Error{}function _(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,r)=>{let s=r.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s})))}function V(e){let r=e.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return _(r)}catch(s){return atob(r)}}function C(e,r){if("string"!==typeof e)throw new M("Invalid token specified: must be a string");r||(r={});const s=!0===r.header?0:1,o=e.split(".")[s];if("string"!==typeof o)throw new M(`Invalid token specified: missing part #${s+1}`);let t;try{t=V(o)}catch(a){throw new M(`Invalid token specified: invalid base64 for part #${s+1} (${a.message})`)}try{return JSON.parse(t)}catch(a){throw new M(`Invalid token specified: invalid json for part #${s+1} (${a.message})`)}}M.prototype.name="InvalidTokenError";const I=(0,E.Ry)().shape({username:(0,E.Z_)().required("Please enter your Username or Email!"),password:(0,E.Z_)().required("Please enter your password!")});var S={name:"LoginComponent",components:{NormalHeading:v.Z,ErrorModal:k.Z,CustomButton:b.Z},methods:{async submit(){I.validate(this.form.values,{abortEarly:!1}).then((async()=>{this.form.errors={username:"",password:""};const e=await y.Z.post("http://localhost:8080/api/v1/user/signin",this.form.values);if(200==e.status){const r=await e.data;console.log("Login successful! "+JSON.stringify(r)),localStorage.setItem("token",r.token);const s=C(r.token);this.store.login({username:this.form.values.username,role:s.role,userId:s.userId}),this.$router.push({path:"/"})}else{const r=await e.data;console.log(JSON.stringify(r)),this.errorMessage="Error registering user: "+r.message,this.isErrorModalVisible=!0}})).catch((e=>{this.errorMessage="Error registering user: "+e.message,this.isErrorModalVisible=!0,e.inner&&Array.isArray(e.inner)&&e.inner.forEach((e=>{this.form.errors[e.path]&&(this.form.errors[e.path]=e.message)}))}))},validate(e){I.validateAt(e,this.form.values).then((()=>{console.log("Success validating onBlur for field: "+e),this.form.errors[e]=""})).catch((r=>{console.log("Error while validating field "+e+" onBlur , "+r.message),this.form.errors[e]=r.message}))}},data(){return{form:{values:{username:"",password:""},errors:{username:"",password:""}},isErrorModalVisible:!1,errorMessage:"",store:(0,x.V)()}}},U=s(89);const Z=(0,U.Z)(S,[["render",w]]);var B=Z,L={name:"LoginView",components:{Login:B}};const $=(0,U.Z)(L,[["render",a]]);var N=$}}]);
//# sourceMappingURL=login.19d006ea.js.map